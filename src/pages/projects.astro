---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getTranslations } from "../i18n/config";
import ProjectsGrid from "../components/ProjectsGrid";

const lang = "es";
const t = await getTranslations(lang);

const title = `${t.projects.title} | ortegadev.com`;
const description =
    "Proyectos destacados: ReviCar, Sorteo Amigo Invisible, automatización con IA y más. Ejemplos de mi trabajo como Full Stack Developer.";

const projects = [
  {
    id: "revicar",
    title: "ReviCar",
    description: "Plataforma inteligente de gestión vehicular con IA predictiva. Apps nativas iOS/Android + Web con Supabase.",
    image: "/images/projects/revicar/revicar-vista-escritorio.webp",
    tags: ["React", "TypeScript", "Supabase", "IA", "Mobile", "Capacitor"],
    url: "https://revicarapp.com",
    github: "https://github.com/miguelicosan/car-care-companion-app",
    year: 2025,
    status: "Desarrollo",
    detailPage: "/projects/revicar",
    content: `
      <h3>La primera aplicación con IA para gestión vehicular predictiva</h3>
      
      <p><strong>ReviCar</strong> revoluciona la gestión del mantenimiento vehicular mediante algoritmos de IA predictiva. Calcula ahorros automáticos, predice costes futuros y optimiza el cuidado de tu vehículo en tiempo real.</p>

      <h4>Características Técnicas Destacadas</h4>
      <ul>
        <li><strong>IA Predictiva</strong>: Score dinámico (0-100) basado en cumplimiento, precisión IA, estado vehicular y optimización de costos</li>
        <li><strong>Base de Datos Vehicular</strong>: 68 marcas, 576 modelos desde 1980 hasta 2025</li>
        <li><strong>Apps Nativas</strong>: iOS y Android desde un mismo codebase con Capacitor.js</li>
        <li><strong>Autenticación Robusta</strong>: OAuth social login (Google, Apple) con email verification</li>
        <li><strong>Responsive Mobile-First</strong>: Optimizado para todos los dispositivos</li>
      </ul>

      <h4>Stack Tecnológico</h4>
      <p><strong>Frontend</strong>: React 18 + TypeScript + Vite + Tailwind CSS + shadcn/ui<br/>
      <strong>Mobile</strong>: Capacitor.js 7.4 (iOS/Android)<br/>
      <strong>Backend</strong>: Supabase (PostgreSQL) + Edge Functions<br/>
      <strong>IA</strong>: Algoritmos predictivos + OpenAI/Gemini<br/>
      <strong>DevOps</strong>: GitHub + Hostinger + SMTP</p>

      <h4>Resultados</h4>
      <ul>
        <li>50+ componentes React</li>
        <li>20+ rutas/páginas</li>
        <li>~15,000 líneas de código</li>
        <li>100% TypeScript coverage</li>
        <li>Lighthouse Score: 95+</li>
        <li>Soporta 2 idiomas (ES, EN)</li>
      </ul>
    `
  },
  {
    id: "amigo-invisible",
    title: "Sorteo Amigo Invisible",
    description: "Crea sorteos gratuitos y seguros con emparejamiento inteligente. Modelo freemium con BuyMeACoffee.",
    image: "/images/projects/amigo-invisible/sorteo-amigo-invisible-vista-escritorio.webp",
    tags: ["Astro", "Supabase", "TypeScript", "Edge Functions", "SEO"],
    url: "https://amigoinvisible.online",
    github: "https://github.com/miguelicosan/sorteoamigoinvisible.online",
    year: 2025,
    status: "Desarrollo",
    detailPage: "/projects/amigo-invisible",
    content: `
      <h3>Organiza sorteos de Amigo Invisible en minutos, sin complicaciones</h3>
      
      <p>Aplicación web moderna para gestionar sorteos de Amigo Invisible de forma segura, rápida y completamente gratuita. Con modelo freemium, personalización de emails y algoritmo inteligente de emparejamiento que evita auto-asignaciones.</p>

      <h4>Características Técnicas Destacadas</h4>
      <ul>
        <li><strong>Wizard Multi-Paso</strong>: Configuración intuitiva en 3 pasos (Configuración → Personalización → Revisión)</li>
        <li><strong>Algoritmo de Derangement</strong>: Emparejamiento circular inteligente sin auto-asignaciones</li>
        <li><strong>Emails Personalizables</strong>: Variables dinámicas ($NOMBRE, $REGALO_PARA) con templates responsivos</li>
        <li><strong>Sistema de Restricciones</strong>: Evita pares específicos (parejas, hermanos, etc.)</li>
        <li><strong>RLS Avanzado</strong>: Row Level Security en PostgreSQL para privacidad garantizada</li>
        <li><strong>SEO Optimizado</strong>: Blog con 10+ artículos, meta tags dinámicos, sitemap</li>
        <li><strong>RGPD Compliant</strong>: Política de privacidad, cookies, auto-borrado a 90 días</li>
      </ul>

      <h4>Stack Tecnológico</h4>
      <p><strong>Frontend</strong>: Astro 5.16.3 + TypeScript + Vanilla CSS + Islands Architecture<br/>
      <strong>Backend</strong>: Supabase (PostgreSQL) + Edge Functions (Deno)<br/>
      <strong>Autenticación</strong>: Sin registro (sorteos anónimos)<br/>
      <strong>DevOps</strong>: Vercel/Netlify + GitHub</p>

      <h4>Resultados</h4>
      <ul>
        <li>5 componentes Astro reutilizables</li>
        <li>10+ páginas (home, blog, legal, premium)</li>
        <li>3 Edge Functions en producción</li>
        <li>~2,500 líneas de código</li>
        <li>Performance: &lt;1s First Contentful Paint</li>
        <li>100% seguridad RLS</li>
      </ul>
    `
  },
  {
    id: "ortegadev",
    title: "ortegadev.com",
    description: "Este portafolio. Full Stack con Astro, animaciones suaves, SEO optimizado y modo oscuro.",
    image: "/images/projects/ortegadev/ortegadev-screenshot.webp",
    tags: ["Astro", "React", "TypeScript", "SCSS", "View Transitions"],
    url: "https://ortegadev.com",
    github: "https://github.com/miguelicosan/ortegadev.com",
    year: 2025,
    status: "Producción",
    detailPage: "/projects/ortegadev",
    content: `
      <h3>Portafolio profesional moderno con animaciones y SEO completo</h3>
      
      <p><strong>ortegadev.com</strong> es un portafolio diseñado para impresionar a recruiters y clientes. Implementa las mejores prácticas de web performance, SEO, accesibilidad y UX/UI moderno.</p>

      <h4>Características Técnicas Destacadas</h4>
      <ul>
        <li><strong>View Transitions API</strong>: Navegación suave entre páginas sin recargar</li>
        <li><strong>Scroll Animations</strong>: Parallax hero, scroll-reveal con IntersectionObserver</li>
        <li><strong>3D Tech Carousel</strong>: Carrusel interactivo con rotación automática y controles</li>
        <li><strong>Dark Mode Único</strong>: Tema oscuro optimizado sin FOUC</li>
        <li><strong>Mobile Menu Avanzado</strong>: Hamburger menu con animaciones spring y blur effect</li>
        <li><strong>Formulario de Contacto</strong>: Validación completa, integración WhatsApp</li>
        <li><strong>SEO Profesional</strong>: Schema.org, hreflang, sitemap, robots.txt</li>
        <li><strong>i18n Completo</strong>: Soporte ES/EN con rutas limpias</li>
      </ul>

      <h4>Stack Tecnológico</h4>
      <p><strong>Framework</strong>: Astro v5 + React (componentes interactivos)<br/>
      <strong>Estilos</strong>: SCSS con variables CSS, responsive design<br/>
      <strong>Animaciones</strong>: CSS custom animations + requestAnimationFrame<br/>
      <strong>Contacto</strong>: React Hook Form + Zod validation<br/>
      <strong>DevOps</strong>: GitHub + Deploy automático<br/>
      <strong>SEO</strong>: Canonical URLs, hreflang, schema.org, noindex</p>

      <h4>Resulta</h4>
      <ul>
        <li>Lighthouse Score: 95+</li>
        <li>Mobile-first responsive design</li>
        <li>12 páginas indexables + 6 legal (noindex)</li>
        <li>Animaciones fluidas en todos los browsers</li>
        <li>0 CLS (Cumulative Layout Shift)</li>
        <li>TTL &lt;2s en conexiones 4G</li>
        <li>100% TypeScript coverage</li>
        <li>Código modular y escalable</li>
      </ul>
    `
  }
];

// CollectionPage + ItemList Schema for projects
const projectsSchema = {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Portfolio de Proyectos",
    "description": description,
    "url": "https://ortegadev.com/projects",
    "mainEntity": {
        "@type": "ItemList",
        "itemListElement": projects.map((project, index) => ({
            "@type": "SoftwareApplication",
            "position": index + 1,
            "name": project.title,
            "description": project.description,
            "url": project.url,
            "applicationCategory": "WebApplication",
            "author": {
                "@type": "Person",
                "name": "Miguel Ángel Ortega Ibáñez",
                "url": "https://ortegadev.com"
            },
            "image": `https://ortegadev.com${project.image}`,
            "datePublished": `${project.year}-01-01`,
            "offers": {
                "@type": "Offer",
                "price": "0",
                "priceCurrency": "EUR"
            }
        }))
    }
};
---

<BaseLayout title={title} description={description} lang={lang}>
    <section class="projects-page py-12">
        <div class="container">
            <div class="projects-header">
                <h1>{t.projects.title}</h1>
                <p class="subtitle">Explora los proyectos en los que he trabajado y descubre las soluciones que creo.</p>
            </div>

            <ProjectsGrid client:load projects={projects} />

            <div class="cta-card">
                <h2>Cada proyecto es una oportunidad de crear algo extraordinario</h2>
                <p class="cta-subtitle">Tengo experiencia transformando ideas en soluciones tecnológicas que generan impacto real en el negocio.</p>
                <a href="/contacto" class="btn btn-primary btn-lg btn-text" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                    <span class="desktop-text">Hablemos de tu siguiente proyecto</span>
                    <span class="mobile-text">Hablemos</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </a>
            </div>
        </div>
    </section>
</BaseLayout>

<style lang="scss">
    @import "../styles/tokens.scss";

    .projects-page {
        min-height: 100vh;
        padding-bottom: $spacing-12;
    }

    .projects-header {
        text-align: center;
        margin-bottom: $spacing-12;

        @media (min-width: $breakpoint-md) and (max-width: 1199px) {
            margin-bottom: $spacing-8;
        }

        h1 {
            margin-bottom: $spacing-4;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                font-size: 2.25rem;
                margin-bottom: $spacing-3;
            }

            @media (max-width: $breakpoint-sm) {
                font-size: 2.25rem;
            }
        }

        .subtitle {
            font-size: $font-size-lg;
            color: var(--color-text-secondary);
            width: 100%;
            margin: 0 auto;
            line-height: $line-height-relaxed;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                font-size: $font-size-base;
            }
        }
    }

    .cta-card {
        background: linear-gradient(135deg, rgba($color-brand-primary, 0.1) 0%, rgba($color-brand-secondary, 0.1) 100%);
        padding: $spacing-10;
        border-radius: $radius-xl;
        border: 1px solid rgba($color-brand-primary, 0.2);
        text-align: center;
        max-width: 800px;
        margin: $spacing-12 auto 0;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.05);
        color: var(--color-text-primary);

        @media (min-width: $breakpoint-md) and (max-width: 1199px) {
            padding: $spacing-6;
            margin: $spacing-8 auto 0;
        }

        @media (max-width: $breakpoint-sm) {
            padding: 2rem;
        }

        h2 {
            font-size: $font-size-3xl;
            margin-bottom: $spacing-4;
            color: var(--color-text-primary);

            @media (max-width: $breakpoint-md) {
                font-size: $font-size-2xl;
            }

            @media (max-width: $breakpoint-sm) {
                font-size: $font-size-xl;
            }
        }

        .cta-subtitle {
            font-size: $font-size-lg;
            color: var(--color-text-secondary);
            margin-bottom: $spacing-8;

            @media (max-width: $breakpoint-md) {
                font-size: $font-size-base;
            }

            @media (max-width: $breakpoint-sm) {
                font-size: $font-size-sm;
            }
        }

        .btn {
            display: inline-block;

            @media (max-width: $breakpoint-sm) {
                display: block;
                width: 100%;
                padding: $spacing-3 $spacing-4;
            }

            .desktop-text {
                display: inline;

                @media (max-width: $breakpoint-sm) {
                    display: none;
                }
            }

            .mobile-text {
                display: none;

                @media (max-width: $breakpoint-sm) {
                    display: inline;
                }
            }
        }
    }
</style>

<script type="application/ld+json" set:html={JSON.stringify(projectsSchema)} />

