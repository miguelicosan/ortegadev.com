---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getTranslations } from "../i18n/config";
import WhatsAppButton from "../components/WhatsAppButton.astro";
import ContactForm from "../components/ContactForm";

const lang = "es";
const t = await getTranslations(lang);

const title = `${t.contact.title} | ortegadev.com`;
const description =
    "Contacta conmigo para tu próximo proyecto. Email, teléfono, WhatsApp o agenda una reunión online.";

// ContactPage Schema
const contactSchema = {
    "@context": "https://schema.org",
    "@type": "ContactPage",
    "name": "Contacto",
    "description": description,
    "url": "https://ortegadev.com/contact",
    "mainEntity": {
        "@type": "Person",
        "name": "Miguel Ángel Ortega Ibáñez",
        "email": "hola@ortegadev.com",
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "Almería",
            "addressCountry": "ES"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "availableLanguage": ["Spanish", "English"],
            "email": "hola@ortegadev.com"
        }
    }
};
---

<BaseLayout title={title} description={description} lang={lang}>
    <section class="contact-page py-12">
        <div class="container">
            <div class="contact-header">
                <h1>{t.contact.title}</h1>
                <p class="subtitle">{t.contact.subtitle}</p>
            </div>

            <div class="contact-grid">
                <div class="contact-info">
                    <h2>Información de contacto</h2>

                    <div class="contact-item">
                        <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"></path>
                            <path
                                d="M22 6L12 13L2 6"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"></path>
                        </svg>
                        <div>
                            <strong>{t.contact.info.email}</strong>
                            <p>
                                <a href="mailto:hola@ortegadev.com"
                                    >hola@ortegadev.com</a
                                >
                            </p>
                            <p>
                                <a href="mailto:miguel@ortegadev.com"
                                    >miguel@ortegadev.com</a
                                >
                            </p>
                        </div>
                    </div>

                    <div class="contact-item">
                        <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="5" y="2" width="14" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 18h0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <div>
                            <strong>WhatsApp</strong>
                            <p>Si prefieres contactarme por WhatsApp, haz clic en el botón de abajo para iniciar una conversación.</p>
                            <p style="margin-top: 0.75rem;">
                                <a
                                    href="https://wa.me/message/3O565QQ2YC35O1"
                                    class="btn btn-outline btn-sm"
                                    target="_blank"
                                    rel="noopener"
                                >
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.511-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c 0 2.096.547 4.142 1.588 5.945L0 24l6.304-1.654a11.882 11.882 0 005.713 1.456h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"
                                        ></path>
                                    </svg>
                                    Abrir WhatsApp
                                </a>
                            </p>
                        </div>
                    </div>

                    <div class="contact-item" id="calendar">
                        <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect
                                x="3"
                                y="4"
                                width="18"
                                height="18"
                                rx="2"
                                stroke="currentColor"
                                stroke-width="2"></rect>
                            <path
                                d="M16 2V6M8 2V6M3 10H21"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"></path>
                        </svg>
                        <div>
                            <strong>{t.contact.calendar.title}</strong>
                            <p>{t.contact.calendar.description}</p>
                            <p style="margin-top: 0.5rem;">
                                <button
                                    class="btn btn-outline btn-sm"
                                    onclick="alert('TODO: Integrar con Calendly.\nPuedes añadir tu URL de Calendly en este archivo:\nsrc/pages/contact.astro')"
                                >
                                    {t.contact.calendar.button}
                                </button>
                            </p>
                        </div>
                    </div>

                    <div class="contact-item" id="social">
                        <svg
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <circle
                                cx="12"
                                cy="12"
                                r="10"
                                stroke="currentColor"
                                stroke-width="2"></circle>
                            <path
                                d="M8 12C8 9.79 9.79 8 12 8C14.21 8 16 9.79 16 12C16 14.21 14.21 16 12 16C9.79 16 8 14.21 8 12Z"
                                stroke="currentColor"
                                stroke-width="2"></path>
                            <circle cx="17" cy="7" r="1.5" fill="currentColor"
                            ></circle>
                        </svg>
                        <div>
                            <strong>Redes Sociales</strong>
                            <p>
                                Sígueme en mis redes para contenido y
                                actualizaciones.
                            </p>
                            <div
                                style="display: flex; gap: 0.75rem; margin-top: 0.75rem; flex-wrap: wrap;"
                            >
                                <a
                                    href="https://github.com/miguelicosan"
                                    class="btn btn-outline btn-sm"
                                    target="_blank"
                                    rel="noopener"
                                    title="GitHub"
                                >
                                    GitHub
                                </a>
                                <a
                                    href="https://linkedin.com/in/miguelortega"
                                    class="btn btn-outline btn-sm"
                                    target="_blank"
                                    rel="noopener"
                                    title="LinkedIn"
                                >
                                    LinkedIn
                                </a>
                                <a
                                    href="https://www.instagram.com/ortegadevcom/"
                                    class="btn btn-outline btn-sm"
                                    target="_blank"
                                    rel="noopener"
                                    title="Instagram"
                                >
                                    Instagram
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="contact-form-container">
                    <h2>Envíame un mensaje</h2>
                    <ContactForm client:idle lang={lang} t={t} />
                </div>
            </div>
        </div>
    </section>
    <WhatsAppButton lang={lang} />
</BaseLayout>

<style lang="scss">
    @import "../styles/tokens.scss";

    .contact-page {
        min-height: 70vh;

        @media (max-width: $breakpoint-sm) {
            padding-top: 3rem;
        }
    }

    .contact-header {
        text-align: center;
        margin-bottom: $spacing-10;

        @media (min-width: $breakpoint-md) and (max-width: 1199px) {
            margin-bottom: $spacing-6;
        }

        h1 {
            margin-bottom: $spacing-4;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                font-size: $font-size-4xl;
                margin-bottom: 0;
            }
        }

        .subtitle {
            font-size: $font-size-xl;
            color: $color-text-secondary;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                font-size: $font-size-lg;
            }
        }
    }

    .contact-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: $spacing-10;

        @media (min-width: $breakpoint-md) and (max-width: 1199px) {
            gap: $spacing-6;
        }

        @media (min-width: $breakpoint-lg) {
            grid-template-columns: 1fr 1fr;
        }
    }

    .contact-info {
        h2 {
            margin-bottom: $spacing-6;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                margin-bottom: 1rem;
            }
        }
    }

    .contact-item {
        display: flex;
        gap: $spacing-4;
        margin-bottom: $spacing-6;
        padding: $spacing-5;
        background-color: $color-bg-secondary;
        border-radius: $radius-lg;

        @media (min-width: $breakpoint-md) and (max-width: 1199px) {
            margin-bottom: 1rem;
            padding: 1rem 2rem 1rem 2rem;
        }

        @media (prefers-color-scheme: dark) {
            background-color: #1d1d1f;
        }

        svg {
            color: $color-brand-primary;
            flex-shrink: 0;
        }

        strong {
            display: block;
            margin-bottom: $spacing-2;
            font-size: $font-size-lg;
        }

        p {
            margin-bottom: $spacing-1;
            line-height: $line-height-normal;
        }

        a {
            color: $color-brand-primary;
            text-decoration: none;

            &:hover {
                text-decoration: underline;
            }
        }
    }

    .contact-form-container {
        h2 {
            margin-bottom: $spacing-6;

            @media (min-width: $breakpoint-md) and (max-width: 1199px) {
                margin-bottom: 1rem;
            }
        }
    }
</style>

<script type="application/ld+json" set:html={JSON.stringify(contactSchema)} />

